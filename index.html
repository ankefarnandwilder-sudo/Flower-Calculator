<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flower Calculator â€“ Artikel & StrauÃŸ Kalkulator</title>

  <style>
    :root{
      --bg:#ffffff;
      --text:#111111;
      --muted:#666666;
      --line:#e8e8e8;

      /* Buttons / Akzente */
      --sage:#6f8f7a;     /* Salbei */
      --sage-2:#5f7f6a;
      --sand:#c7b29a;     /* Sand/Beige */
      --sand-2:#b59f86;

      --card:#fafafa;
      --shadow: 0 8px 24px rgba(0,0,0,.06);
      --radius: 14px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color:var(--text);
      background:var(--bg);
      line-height:1.35;
    }

    .wrap{
      max-width: 1080px;
      margin: 24px auto 60px;
      padding: 0 16px;
    }

    header{
      display:flex;
      gap:16px;
      align-items:flex-start;
      justify-content:space-between;
      margin-bottom: 16px;
      flex-wrap:wrap;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width: 260px;
    }
    h1{
      font-size: 22px;
      margin:0;
      letter-spacing:.2px;
    }
    .subtitle{
      color:var(--muted);
      font-size: 14px;
    }

    .toolbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    button{
      border:0;
      border-radius: 999px;
      padding: 10px 14px;
      font-weight: 650;
      cursor:pointer;
      transition: transform .04s ease, filter .12s ease;
      white-space:nowrap;
    }
    button:active{transform: translateY(1px)}
    .btn-sage{background:var(--sage); color:white;}
    .btn-sage:hover{filter:brightness(.95)}
    .btn-sand{background:var(--sand); color:#222;}
    .btn-sand:hover{filter:brightness(.97)}
    .btn-ghost{
      background:transparent;
      color:var(--text);
      border:1px solid var(--line);
    }
    .btn-ghost:hover{filter:brightness(.98)}

    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .table-wrap{
      width:100%;
      overflow:auto;
    }

    table{
      width:100%;
      border-collapse: collapse;
      min-width: 860px; /* damit es auf Laptop sauber aussieht, am Handy scrollt die Tabelle horizontal */
    }

    thead th{
      text-align:left;
      font-size: 13px;
      color: var(--muted);
      font-weight: 650;
      padding: 14px 12px;
      border-bottom:1px solid var(--line);
      background: #fff;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    tbody td{
      padding: 10px 12px;
      border-bottom: 1px solid var(--line);
      vertical-align: middle;
      background: #fff;
    }

    tbody tr:hover td{
      background: #fcfcfc;
    }

    input[type="text"], input[type="number"]{
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 10px 10px;
      font-size: 14px;
      outline:none;
      background:#fff;
    }
    input[type="number"]{
      text-align:right;
      font-variant-numeric: tabular-nums;
    }
    input:focus{
      border-color: rgba(111,143,122,.65);
      box-shadow: 0 0 0 3px rgba(111,143,122,.15);
    }

    .num{
      text-align:right;
      font-variant-numeric: tabular-nums;
      white-space:nowrap;
    }

    .row-actions{
      display:flex;
      gap:8px;
      justify-content:flex-end;
    }
    .icon-btn{
      border-radius: 10px;
      padding: 10px 10px;
      border:1px solid var(--line);
      background:#fff;
      cursor:pointer;
    }
    .icon-btn:hover{filter:brightness(.98)}
    .icon-btn.danger{
      border-color: rgba(0,0,0,.08);
    }

    .footer{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      padding: 16px;
      background:#fff;
    }

    .total{
      font-size: 18px;
      font-weight: 800;
      letter-spacing:.2px;
    }
    .total small{
      color: var(--muted);
      font-weight: 650;
      margin-right: 8px;
    }

    .small-note{
      color: var(--muted);
      font-size: 13px;
      padding: 10px 2px 0;
    }

    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      border:1px solid var(--line);
      border-radius: 999px;
      padding: 8px 12px;
      background:#fff;
      color: var(--muted);
      font-size: 13px;
      font-weight: 650;
    }

    .status{
      color: var(--muted);
      font-size: 13px;
      padding: 0 2px;
    }

    @media (max-width: 640px){
      h1{font-size: 20px}
      .subtitle{font-size: 13px}
      button{padding: 10px 12px}
      .total{font-size: 17px}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Flower Calculator</h1>
        <div class="subtitle">
          Artikel / StrauÃŸ / WerkstÃ¼ck kalkulieren â€“ ohne Taschenrechner-Chaos. (Werbefrei, offline nutzbar)
        </div>
      </div>

      <div class="toolbar">
        <span class="pill">ðŸŒ¿ Salbei & Sand</span>
        <button class="btn-sage" id="addRowBtn">+ Position hinzufÃ¼gen</button>
        <button class="btn-sand" id="saveBtn">Speichern</button>
        <button class="btn-ghost" id="loadBtn">Laden</button>
        <button class="btn-ghost" id="csvBtn">CSV Export</button>
        <button class="btn-ghost" id="demoBtn">Beispielwerte</button>
        <button class="btn-ghost" id="clearBtn">Alles lÃ¶schen</button>
      </div>
    </header>

    <div class="card">
      <div class="table-wrap">
        <table aria-label="Kalkulationstabelle">
          <thead>
            <tr>
              <th style="width:40%">Artikel / Blume</th>
              <th style="width:14%" class="num">Einzelpreis (â‚¬)</th>
              <th style="width:14%" class="num">Menge</th>
              <th style="width:16%" class="num">Summe (â‚¬)</th>
              <th style="width:16%" class="num">Aktion</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
      </div>

      <div class="footer">
        <div class="total">
          <small>Gesamtsumme:</small>
          <span id="grandTotal">0,00 â‚¬</span>
        </div>

        <div class="status" id="statusText">Bereit.</div>
      </div>
    </div>

    <div class="small-note">
      Tipp: Du kannst die Tabelle einfach nach unten â€žwachsenâ€œ lassen â€“ es gibt keine Begrenzung.
      Speichern/Laden funktioniert im gleichen Browser (z. B. im Laden-PC).
    </div>
  </div>

  <script>
    // -------- Helpers --------
    const fmtEUR = (value) => {
      const n = Number(value);
      const safe = isFinite(n) ? n : 0;
      return safe.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' â‚¬';
    };

    const parseNum = (val) => {
      if (val === null || val === undefined) return 0;
      // erlaubt Eingaben wie "1,50"
      const s = String(val).trim().replace(/\./g, '').replace(',', '.');
      const n = Number(s);
      return isFinite(n) ? n : 0;
    };

    const setStatus = (msg) => {
      const el = document.getElementById('statusText');
      el.textContent = msg;
      clearTimeout(setStatus._t);
      setStatus._t = setTimeout(() => el.textContent = 'Bereit.', 1800);
    };

    // -------- State --------
    const rowsEl = document.getElementById('rows');
    const grandTotalEl = document.getElementById('grandTotal');

    const state = {
      rows: [] // {id, name, price, qty}
    };

    const newId = () => Math.random().toString(36).slice(2, 10);

    // -------- Rendering --------
    function calcRowSum(r){
      const price = parseNum(r.price);
      const qty = parseNum(r.qty);
      return price * qty;
    }

    function calcGrandTotal(){
      return state.rows.reduce((acc, r) => acc + calcRowSum(r), 0);
    }

    function render(){
      rowsEl.innerHTML = '';

      state.rows.forEach((r, idx) => {
        const tr = document.createElement('tr');

        // Name
        const tdName = document.createElement('td');
        const inpName = document.createElement('input');
        inpName.type = 'text';
        inpName.placeholder = 'z. B. Rose, Tulpe, Eukalyptus, Band, Vase â€¦';
        inpName.value = r.name ?? '';
        inpName.addEventListener('input', (e) => {
          r.name = e.target.value;
        });
        tdName.appendChild(inpName);

        // Price
        const tdPrice = document.createElement('td');
        const inpPrice = document.createElement('input');
        inpPrice.type = 'number';
        inpPrice.step = '0.01';
        inpPrice.min = '0';
        inpPrice.placeholder = '0,00';
        inpPrice.value = (r.price ?? '');
        inpPrice.addEventListener('input', (e) => {
          r.price = e.target.value;
          updateTotals();
        });
        tdPrice.appendChild(inpPrice);

        // Qty
        const tdQty = document.createElement('td');
        const inpQty = document.createElement('input');
        inpQty.type = 'number';
        inpQty.step = '1';
        inpQty.min = '0';
        inpQty.placeholder = '0';
        inpQty.value = (r.qty ?? '');
        inpQty.addEventListener('input', (e) => {
          r.qty = e.target.value;
          updateTotals();
        });
        tdQty.appendChild(inpQty);

        // Sum
        const tdSum = document.createElement('td');
        tdSum.className = 'num';
        tdSum.textContent = fmtEUR(calcRowSum(r));

        // Actions
        const tdAct = document.createElement('td');
        tdAct.className = 'num';
        const wrap = document.createElement('div');
        wrap.className = 'row-actions';

        const btnDup = document.createElement('button');
        btnDup.className = 'icon-btn';
        btnDup.type = 'button';
        btnDup.title = 'Zeile duplizieren';
        btnDup.textContent = 'âŽ˜';
        btnDup.addEventListener('click', () => {
          const copy = { id: newId(), name: r.name, price: r.price, qty: r.qty };
          state.rows.splice(idx + 1, 0, copy);
          render();
          updateTotals();
          setStatus('Zeile dupliziert.');
        });

        const btnDel = document.createElement('button');
        btnDel.className = 'icon-btn danger';
        btnDel.type = 'button';
        btnDel.title = 'Zeile lÃ¶schen';
        btnDel.textContent = 'ðŸ—‘';
        btnDel.addEventListener('click', () => {
          state.rows = state.rows.filter(x => x.id !== r.id);
          if (state.rows.length === 0) addRow(); // nie komplett leer
          render();
          updateTotals();
          setStatus('Zeile gelÃ¶scht.');
        });

        wrap.appendChild(btnDup);
        wrap.appendChild(btnDel);
        tdAct.appendChild(wrap);

        tr.appendChild(tdName);
        tr.appendChild(tdPrice);
        tr.appendChild(tdQty);
        tr.appendChild(tdSum);
        tr.appendChild(tdAct);

        rowsEl.appendChild(tr);
      });

      updateTotals();
    }

    function updateTotals(){
      // Update row sums
      const trs = rowsEl.querySelectorAll('tr');
      trs.forEach((tr, i) => {
        const r = state.rows[i];
        const tdSum = tr.children[3];
        tdSum.textContent = fmtEUR(calcRowSum(r));
      });

      // Update grand total
      grandTotalEl.textContent = fmtEUR(calcGrandTotal());
    }

    // -------- Actions --------
    function addRow(prefill = {}){
      state.rows.push({
        id: newId(),
        name: prefill.name ?? '',
        price: prefill.price ?? '',
        qty: prefill.qty ?? ''
      });
    }

    function clearAll(){
      state.rows = [];
      addRow();
      addRow();
      addRow();
      render();
      setStatus('Alles gelÃ¶scht.');
    }

    function setDemo(){
      state.rows = [];
      [
        { name:'Rose', price:'2.50', qty:'7' },
        { name:'Tulpe', price:'1.40', qty:'10' },
        { name:'Eukalyptus', price:'3.20', qty:'2' },
        { name:'Band', price:'0.80', qty:'1' }
      ].forEach(addRow);
      addRow(); addRow(); // Platz
      render();
      setStatus('Beispielwerte geladen.');
    }

    // Save/Load in browser (LocalStorage)
    const STORAGE_KEY = 'flower_calculator_rows_v1';

    function save(){
      const payload = {
        savedAt: new Date().toISOString(),
        rows: state.rows.map(r => ({ name:r.name ?? '', price:r.price ?? '', qty:r.qty ?? '' }))
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
      setStatus('Gespeichert (im Browser).');
    }

    function load(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw){
        setStatus('Kein gespeicherter Stand gefunden.');
        return;
      }
      try{
        const data = JSON.parse(raw);
        state.rows = [];
        (data.rows || []).forEach(addRow);
        if(state.rows.length === 0){ addRow(); addRow(); addRow(); }
        render();
        setStatus('Geladen.');
      }catch(e){
        setStatus('Laden fehlgeschlagen.');
      }
    }

    // CSV Export
    function exportCSV(){
      const header = ['Artikel','Einzelpreis','Menge','Summe'];
      const lines = [header.join(';')];

      state.rows.forEach(r => {
        const sum = calcRowSum(r);
        const row = [
          (r.name ?? '').replace(/;/g, ','),
          parseNum(r.price).toFixed(2).replace('.', ','),
          String(parseNum(r.qty)).replace('.', ','),
          sum.toFixed(2).replace('.', ',')
        ];
        lines.push(row.join(';'));
      });

      lines.push(['','','Gesamt', parseNum(calcGrandTotal()).toFixed(2).replace('.', ',')].join(';'));

      const blob = new Blob([lines.join('\n')], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'flower-calculator.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      setStatus('CSV exportiert.');
    }

    // -------- Wire up buttons --------
    document.getElementById('addRowBtn').addEventListener('click', () => {
      addRow();
      render();
      setStatus('Position hinzugefÃ¼gt.');
      // optional: nach unten scrollen
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    });

    document.getElementById('clearBtn').addEventListener('click', () => {
      if(confirm('Wirklich alles lÃ¶schen?')){
        clearAll();
      }
    });

    document.getElementById('demoBtn').addEventListener('click', () => setDemo());
    document.getElementById('saveBtn').addEventListener('click', () => save());
    document.getElementById('loadBtn').addEventListener('click', () => load());
    document.getElementById('csvBtn').addEventListener('click', () => exportCSV());

    // -------- Init --------
    // Start mit mehr als 10 Zeilen? Kein Problem: wir starten direkt mit 15 leeren Positionen.
    for(let i=0; i<15; i++) addRow();
    render();
  </script>
</body>
</html>

     
  
 
   
 

 
  
  
  
  

  
   
   
    
   
 
     
    
 
  


  
    
   


  

 
  

 
  
 

   
 
   
    
      
   
  
    
     

    
     
     
  



 

 
  
  

 
    
 


   
 

  
 
  
